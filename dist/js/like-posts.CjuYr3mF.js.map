{"version":3,"file":"like-posts.CjuYr3mF.js","sources":["../../source/js/front/likedCounter.ts","../../source/js/front/storage/userStorage.ts","../../source/js/front/storage/localStorage.ts","../../source/js/front/storage/likeInstancesStorage.ts","../../source/js/front/helpers/likedPostsStructurer.ts","../../source/js/front/helpers/likedPostsApiUrlBuilder.ts","../../source/js/front/module/likeModule.ts","../../source/js/front/module/shared.ts","../../source/js/front/module/likeModuleFactory.ts","../../source/js/front/module/share.ts","../../source/js/front/module/shareFactory.ts","../../source/js/front/like/like.ts","../../source/js/front/like/likeFactory.ts","../../source/js/like-posts.ts"],"sourcesContent":["import StorageInterface from \"./storage/storageInterface\";\n\nclass LikedCounter {\n    counterElements: (Element | null)[];\n    constructor(private likeStorage: StorageInterface, counterIcons: Element[]) {       \n        this.counterElements = this.addCounterToIcon(counterIcons);\n        this.updateCounter();\n    }\n\n    addCounterToIcon(counterIcons: Element[]) {\n        const icons = counterIcons.map((counterIcon: Element) => { \n            counterIcon.innerHTML += this.getLikeIconMarkup();\n            return counterIcon.querySelector('[data-js-like-counter]');\n        });\n        \n        return icons;\n    }\n\n    updateCounter() {\n        const likedPostsLength = Object.keys(this.likeStorage.get()).length;\n        \n        this.counterElements.forEach((counterElement: Element | null) => {\n            if (counterElement) {\n                counterElement.innerHTML = likedPostsLength.toString();\n            }\n\n            if (likedPostsLength === 0) {\n                counterElement?.classList.add('u-display--none');\n            } else {\n                counterElement?.classList.remove('u-display--none');\n            }\n        });\n    }\n\n    private getLikeIconMarkup() {\n        return '<span class=\"u-display--none like-counter\" data-js-like-counter></span>'\n    }\n}\n\nexport default LikedCounter;\n\nexport function initializeLikedCounter(likeStorage: StorageInterface) {\n    const counterIcons = document.querySelectorAll('[data-js-like-icon-counter]');\n    if (counterIcons.length === 0) { return };\n\n    const likeCounterInstance = new LikedCounter(likeStorage, [...counterIcons]);\n    window.addEventListener('likedPostsLengthUpdated', (e: Event) => {\n        likeCounterInstance.updateCounter();\n    });\n}","import { LikedPostsMeta, LikedPosts, WpApiSettings } from \"../like-posts\";\nimport StorageInterface from \"./storageInterface\";\n\ndeclare const wpApiSettings: any;\n\nclass UserStorage implements StorageInterface {\n    private likedPosts: LikedPostsMeta = {};\n    private userEndpoint: string = '';\n\n    constructor(\n        private wpApiSettings: WpApiSettings,\n        private userId: number,\n        likedPostsMeta: any\n    ) {\n        this.userEndpoint = `${this.wpApiSettings.root}wp/v2/users/${this.userId}`;\n        this.likedPosts = this.sanitizeLikedPostsMeta(likedPostsMeta);\n    }\n\n    public get(): LikedPostsMeta {\n        return this.likedPosts;\n    }\n\n    public set(postId: string, postType: string, blogId: string): void {\n        const key = `${blogId}-${postId}`;\n        const runtimeLikedPosts = this.get();\n\n        if (runtimeLikedPosts[key]) {\n            delete runtimeLikedPosts[key];\n        } else {\n            runtimeLikedPosts[key] = {\n                postType: postType,\n                blogId: blogId,\n                postId: postId,\n                likedAt: Date.now(),\n                website: this.wpApiSettings.root\n            };\n        }\n\n        fetch(this.userEndpoint, {\n            method: 'PATCH',\n            headers: {\n                'Content-Type': 'application/json',\n                'X-WP-NONCE': wpApiSettings?.nonce ?? '',\n            },\n            body: JSON.stringify({\n                meta: {\n                    likedPosts: runtimeLikedPosts\n                }\n            }),\n        })\n            .then(response => {\n                if (!response.ok) {\n                    throw new Error('Failed to update user data');\n                }\n                return response.json();\n            })\n            .catch(error => {\n                console.error('Error:', error);\n            });\n    }\n\n   private sanitizeLikedPostsMeta(likedPostsMeta: any): LikedPostsMeta {\n        if (!likedPostsMeta || typeof likedPostsMeta !== 'object') return {};\n\n        return Object.fromEntries(\n            Object.entries(likedPostsMeta).filter(([_, value]) =>\n                value &&\n                typeof value === 'object' &&\n                'postId' in value &&\n                'blogId' in value &&\n                'postType' in value &&\n                'likedAt' in value\n            )\n        ) as LikedPostsMeta;\n    }\n}\n\nexport default UserStorage;","import { LikedPostsMeta, LikedPosts, WpApiSettings } from \"../like-posts\";\nimport StorageInterface from \"./storageInterface\";\n\nclass LocalStorage implements StorageInterface {\n\tprivate localeStorageKey: string = 'liked-posts-v2';\n\tprivate likedPosts: LikedPostsMeta;\n\n\tconstructor(\n\t\tprivate wpApiSettings: WpApiSettings,\n\t\tprivate currentBlogId: string\n\t) {\n\t\tthis.likedPosts = this.sanitizeLikedPosts(JSON.parse(localStorage.getItem(this.localeStorageKey) || '{}'));\n\t}\n\n    public get(): LikedPostsMeta {\n        return this.likedPosts;\n    }\n\n    public set(postId: string, postType: string, blogId: string): void {\n\t\tlet likedPostsIds = this.get();\n\t\tconst key = `${blogId}-${postId}`;\n\n\t\tif (likedPostsIds[key]) {\n\t\t\tdelete likedPostsIds[key];\n\t\t} else {\n\t\t\tlikedPostsIds[key] = {\n\t\t\t\tpostType: postType,\n\t\t\t\tblogId: blogId,\n\t\t\t\tpostId: postId,\n\t\t\t\tlikedAt: Date.now(),\n\t\t\t\twebsite: this.wpApiSettings.root\n\t\t\t};\n\t\t}\n\n\t\tlocalStorage.setItem(this.localeStorageKey, JSON.stringify(likedPostsIds));\n\t\tthis.likedPosts = likedPostsIds;\n\t}\n\n\t// Sanitizes how old liked posts are stored in local storage.\n\t// This is for backwards compatibility with older versions of the plugin.\n\tprivate sanitizeLikedPosts(likedPosts: LikedPosts|LikedPostsMeta): any {\n\n\t\tconst localLikedPosts: LikedPostsMeta = {};\n\t\tfor (const id in likedPosts) {\n\t\t\tif (typeof likedPosts[id] !== 'string') {\n\t\t\t\tlocalLikedPosts[id] = likedPosts[id];\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst key = `${this.currentBlogId}-${id}`;\n\n\t\t\tlocalLikedPosts[key] = {\n\t\t\t\tpostType: likedPosts[id],\n\t\t\t\tblogId: this.currentBlogId,\n\t\t\t\tpostId: id,\n\t\t\t\tlikedAt: Date.now(),\n\t\t\t\twebsite: this.wpApiSettings.root\n\t\t\t}\n\t\t}\n\n\t\treturn localLikedPosts;\n\t}\n}\n\nexport default LocalStorage;","import Like from '../like/like';\n\ninterface LikeInstancesStorageInterface {\n    [postId: string]: Like[];\n}\n\nclass LikeInstancesStorage {\n    private instances: LikeInstancesStorageInterface = {};\n\n    /**\n     * Returns all instances of a like button with a given postId.\n     * @param postId - The post ID to retrieve instances for.\n     * @returns Array of Like instances.\n     */\n    public getInstances(postId: string): Like[] {\n        return this.instances[postId] || [];\n    }\n\n    /**\n     * Adds a new instance of a like button with a given postId.\n     * @param postId - The post ID to associate with the instance.\n     * @param likeInstance - The Like instance to add.\n     */\n    public addInstance(postId: string, likeInstance: Like): void {\n        if (!this.instances[postId]) {\n            this.instances[postId] = [];\n        }\n\n        this.instances[postId].push(likeInstance);\n    }\n}\n\nexport default LikeInstancesStorage;\n\n","import { LikedPostsMeta, StructuredLikedPosts } from \"../like-posts\";\n\nclass LikedPostsStructurer {\n    public structure(likedPosts: LikedPostsMeta): StructuredLikedPosts {\n        const strucuturedLikedPosts: StructuredLikedPosts = {};\n        for (const id in likedPosts) {\n            if (!strucuturedLikedPosts[likedPosts[id].website]) {\n                strucuturedLikedPosts[likedPosts[id].website] = [];\n            }\n\n            strucuturedLikedPosts[likedPosts[id].website].push(likedPosts[id]);\n        }\n\n        return strucuturedLikedPosts;\n    }\n}\n\nexport default LikedPostsStructurer;","import { LikedPostMeta, LikedPostsMeta, WpApiSettings } from \"../like-posts\";\n\nclass LikedPostsApiUrlBuilder {\n    constructor(private wpApiSettings: WpApiSettings) {}\n\n    public build(likedPosts: LikedPostsMeta, appearance: string, postTypes?: string[]): string {\n        let postIds: string[] = [];\n        for (const postId in likedPosts) {\n            if (!postTypes || postTypes.includes(likedPosts[postId].postType)) {\n                postIds.push(postId);\n            }\n        }\n\n        return `${this.wpApiSettings.root}like/v1/ids=${postIds.join(',')}?html&appearance=${appearance}&cache-bust=${Date.now()}`;\n    }\n}\n\nexport default LikedPostsApiUrlBuilder;","import LikedPostsApiUrlBuilder from \"../helpers/likedPostsApiUrlBuilder\";\nimport { LikedPostsMeta, LikedPosts, WpApiSettings } from \"../like-posts\";\nimport StorageInterface from \"../storage/storageInterface\";\n\nclass LikeModule {\n    private displayNoneClass: string = 'u-display--none';\n    private likedPosts: LikedPostsMeta;\n\tconstructor(\n        private wpApiSettings: WpApiSettings,\n        private likeStorage: StorageInterface,\n        private sharedPosts: string|null,\n        private likedPostsApiUrlBuilder: LikedPostsApiUrlBuilder,\n        private postTypesToShow: Array<string>,\n        private postAppearance: string,\n        private renderContainer: HTMLElement,\n        private noPostsNotice: HTMLElement,\n        private preLoaders: NodeListOf<HTMLElement>,\n\n    ) {\n        this.likedPosts = this.likeStorage.get();\n        if (this.sharedPosts) {\n            const decodedSharedPosts = atob(this.sharedPosts);\n            const apiUrl = JSON.parse(decodedSharedPosts);\n\n            if (typeof apiUrl === 'string' && apiUrl.length > 0) {\n                this.fetchPosts(apiUrl);\n            } else {\n                console.error('Invalid shared posts data:', this.sharedPosts);\n                this.noPostsFound();\n            }\n        } else {\n            this.handleLikedPosts();\n        }\n    }\n\n    /**\n     * Handles liked posts for the current user/session.\n     */\n    private handleLikedPosts(): void {\n        if (Object.keys(this.likedPosts).length <= 0) {\n            this.noPostsFound();\n            return;\n        }\n\n        const apiUrl = this.likedPostsApiUrlBuilder.build(\n            this.likedPosts,\n            this.postAppearance,\n            this.postTypesToShow\n        );\n\n        this.fetchPosts(apiUrl);\n\t}\n\n    /**\n     * Fetches posts from the API and handles the response.\n     * @param apiUrl - The API URL to fetch posts from.\n     */\n    private fetchPosts(apiUrl: string): void {\n        fetch(\n            apiUrl,\n            {\n                credentials: 'include',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'X-WP-NONCE': this.wpApiSettings?.nonce ?? '',\n                }\n            }\n        )\n            .then(response => {\n                if (!response.ok) {\n                    throw new Error('Failed to fetch post');\n                }\n                return response.json();\n            })\n            .then(postsMarkup => {\n                this.handleFetched(postsMarkup);\n            })\n            .catch(error => {\n                console.error('Fetch error:', error);\n                this.noPostsFound();\n            });\n    }\n\n\n    /**\n     * Handles the fetched posts markup and updates the DOM.\n     * @param posts - The HTML markup for the posts.\n     */\n    private handleFetched(posts: string): void {\n        if (!posts || typeof posts !== 'string') {\n            this.noPostsFound();\n            return;\n        }\n\n        this.removePreloaders();\n        this.renderContainer.innerHTML = posts;\n    }\n\n    /**\n     * Removes all preloader elements from the DOM.\n     */\n    private removePreloaders() {\n        this.preLoaders.forEach((preloader) => {\n            preloader.remove();\n        });\n    }\n\n    /**\n     * Handles the case when no posts are found.\n     */\n    private noPostsFound() {\n        this.noPostsNotice.classList.remove(this.displayNoneClass);\n        this.removePreloaders();\n    }\n}\n\nexport default LikeModule;\n","class Shared {\n    private displayNoneClass: string = 'u-display--none';\n    private nameParamKey: string = 'liked-name';\n    private excerptParamKey: string = 'liked-excerpt';\n\n    constructor(\n        private renderContainer: HTMLElement,\n        private urlParams: URLSearchParams,\n        private title: HTMLElement,\n        private excerpt: HTMLElement\n    ) {\n        this.addSharedData();\n    }\n\n    /**\n     * Adds shared data (name and excerpt) to the DOM from URL parameters.\n     */\n    private addSharedData() {\n        let listName = this.urlParams.get(this.nameParamKey);\n        let listExcerpt = this.urlParams.get(this.excerptParamKey);\n        if (this.title && listName) {\n            this.setSharedValue(this.title, listName);\n        }\n\n        if (this.excerpt && listExcerpt) {\n            this.setSharedValue(this.excerpt, listExcerpt);\n        }\n    }\n\n    /**\n     * Sets the shared value for an element and makes it visible.\n     * @param element - The element to update.\n     * @param value - The value to set (encoded).\n     */\n    private setSharedValue(element: HTMLElement, value: string) {\n        element.textContent = this.sanitizeUrlParams(value);\n        element.classList.remove(this.displayNoneClass);\n    }\n\n    /**\n     * Decodes and sanitizes a base64-encoded string from URL parameters.\n     * @param encodedString - The encoded string to decode and sanitize.\n     * @returns The sanitized string.\n     */\n    private sanitizeUrlParams(encodedString: string) {\n\t\tlet string = atob(encodedString);\n\t\tstring = string.replace(/(<([^>]+)>)/gi, '');\n\t\treturn string;\n\t}\n}\n\nexport default Shared;","import LikedPostsApiUrlBuilder from \"../helpers/likedPostsApiUrlBuilder\";\nimport { WpApiSettings } from \"../like-posts\";\nimport StorageInterface from \"../storage/storageInterface\";\nimport LikeModule from \"./likeModule\";\nimport Shared from \"./shared\";\n\nclass LikeModuleFactory {\n    constructor(\n        private wpApiSettings: WpApiSettings,\n        private likeStorage: StorageInterface,\n        private urlParams: URLSearchParams,\n        private sharedPosts: string|null,\n    ) {}\n\n    /**\n     * Creates a LikeModule or Shared module for the given container.\n     * @param likePostsContainer - The container element for like posts.\n     * @returns LikeModule instance or undefined if creation fails.\n     */\n    public create(likePostsContainer: HTMLElement): LikeModule | undefined {\n        const [postTypesToShow, postAppearance] = this.extractAttributes(likePostsContainer);\n        const [renderContainer, noPostsNotice, preLoaders] = this.extractElements(likePostsContainer);\n\n        const likedPostsApiUrlBuilder = new LikedPostsApiUrlBuilder(this.wpApiSettings);\n\n        if (!postTypesToShow || !renderContainer || !noPostsNotice || !preLoaders) {\n            return undefined;\n        }\n\n        if (this.sharedPosts) {\n            const [title, excerpt] = this.extractSharedElements(likePostsContainer);\n\n            new Shared(\n                renderContainer as HTMLElement,\n                this.urlParams, \n                title as HTMLElement, \n                excerpt as HTMLElement\n            );\n        }\n\n        return new LikeModule(\n            this.wpApiSettings,\n            this.likeStorage,\n            this.sharedPosts,\n            likedPostsApiUrlBuilder,\n            postTypesToShow,\n            postAppearance,\n            renderContainer as HTMLElement,\n            noPostsNotice as HTMLElement,\n            preLoaders as NodeListOf<HTMLElement>,\n        );\n    }\n\n    /**\n     * Extracts shared elements (title and excerpt) from the container.\n     * @param likePostsContainer - The container element.\n     * @returns Tuple of title and excerpt elements.\n     */\n    private extractSharedElements(likePostsContainer: HTMLElement): [HTMLElement | null, HTMLElement | null] {\n        const title = likePostsContainer.querySelector('[data-js-liked-posts-share-title]');\n        const excerpt = likePostsContainer.querySelector('[data-js-liked-posts-share-excerpt]');\n\n        return [title as HTMLElement, excerpt as HTMLElement];\n    }\n\n    /**\n     * Extracts key elements (render container, notice, preloaders) from the container.\n     * @param likePostsContainer - The container element.\n     * @returns Tuple of render container, notice, and preloaders.\n     */\n    private extractElements(likePostsContainer: HTMLElement): [HTMLElement | null, HTMLElement | null, NodeListOf<HTMLElement> | null] {\n        const renderContainer = likePostsContainer.querySelector('[data-js-render-container]');\n        const noPostsNotice = likePostsContainer.querySelector('[data-js-no-posts-notice]');\n        const preLoaders = likePostsContainer.querySelectorAll('[data-js-like-preloader]');\n\n        return [renderContainer as HTMLElement, noPostsNotice as HTMLElement, preLoaders as NodeListOf<HTMLElement>];\n    }\n\n    /**\n     * Extracts post types and appearance attributes from the container.\n     * @param likePostsContainer - The container element.\n     * @returns Tuple of post types array and appearance string.\n     */\n    private extractAttributes(likePostsContainer: HTMLElement): [Array<string>, string] {\n        const postTypesToShow = JSON.parse(likePostsContainer.getAttribute('data-js-like-posts-post-types') || '[]');\n        const postAppearance  = likePostsContainer.getAttribute('data-js-like-posts-appearance') || 'collection';\n\n        return [postTypesToShow, postAppearance];\n    }\n}\n\nexport default LikeModuleFactory;","import LikedPostsApiUrlBuilder from '../helpers/likedPostsApiUrlBuilder';\nimport LikedPostsStructurer from '../helpers/likedPostsStructurer';\nimport StorageInterface from '../storage/storageInterface';\n\nclass Share {\n    private sharedParamKey: string = 'liked-posts';\n    private displayNoneClass: string = 'u-display--none';\n\n    constructor(\n        private likeStorage: StorageInterface,\n        private postTypesToShow: string[],\n        private postAppearance: string,\n        private likedPostsStructurer: LikedPostsStructurer,\n        private likedPostsApiUrlBuilder: LikedPostsApiUrlBuilder,\n        private shareButton: HTMLButtonElement,\n        private urlField: HTMLInputElement,\n        private nameField: HTMLInputElement,\n        private excerptField: HTMLInputElement,\n    ) {        \n        const urlParams = new URLSearchParams(window.location.search);\n\n        const encodedLikedPosts = urlParams.get(this.sharedParamKey);\n\n        if (!encodedLikedPosts) {\n            this.renderShareLink();\n        }\n    }\n\n    /**\n     * Renders the share link and sets up event listeners for name and excerpt fields.\n     */\n    private renderShareLink() {\n        const url = window.location.href.split('?')[0];\n        const encodedLikedPostsParam = this.generateEncodedLikedPostsParam();\n\n        if (!encodedLikedPostsParam) return;\n\n        const shareLink = `${url}${encodedLikedPostsParam}`;\n\n        this.urlField.value = shareLink;\n        this.nameField.addEventListener('input', this.updateShareLink.bind(this, this.urlField, this.nameField, this.excerptField));\n        this.excerptField.addEventListener('input', this.updateShareLink.bind(this, this.urlField, this.nameField, this.excerptField));\n\n        this.shareButton.classList.remove(this.displayNoneClass);\n    }\n\n    /**\n     * Generates the encoded liked posts parameter for sharing.\n     * @returns The encoded liked posts query string or false if no liked posts.\n     */\n    private generateEncodedLikedPostsParam() {\n        const likedPosts = this.likeStorage.get();\n        if (Object.keys(likedPosts).length == 0) {\n            return false;\n        }\n\n        const apiUrls = this.likedPostsApiUrlBuilder.build(\n            likedPosts,\n            this.postAppearance,\n            this.postTypesToShow\n        );\n\n        const encodedApiUrls = btoa(JSON.stringify(apiUrls));\n    \n        return '?liked-posts=' + encodedApiUrls;\n    }\n\n    /**\n     * Updates the share link with the encoded name and excerpt.\n     * @param urlField - The input field for the share URL.\n     * @param nameField - The input field for the name.\n     * @param excerptField - The input field for the excerpt.\n     */\n    private updateShareLink(urlField: HTMLInputElement, nameField: HTMLInputElement, excerptField: HTMLInputElement) {\n        const newName = btoa(nameField.value);\n        const newExcerpt = btoa(excerptField.value);\n        const url = new URL(urlField.value);\n\n        if (url) {\n            url.searchParams.set('liked-name', newName);\n            url.searchParams.set('liked-excerpt', newExcerpt);\n\n            if (!newName) {\n                url.searchParams.delete('liked-name');\n            }\n\n            if (!newExcerpt) {\n                url.searchParams.delete('liked-excerpt');\n            }\n        }\n\n        urlField.value = url.href;\n    }\n}\n\nexport default Share;","import LikedPostsApiUrlBuilder from \"../helpers/likedPostsApiUrlBuilder\";\nimport LikedPostsStructurer from \"../helpers/likedPostsStructurer\";\nimport StorageInterface from \"../storage/storageInterface\";\nimport Share from \"./share\";\n\nclass ShareFactory {\n    constructor(\n        private likeStorage: StorageInterface,\n        private likedPostsStructurer: LikedPostsStructurer,\n        private likedPostsApiUrlBuilder: LikedPostsApiUrlBuilder\n    ) {}\n\n    /**\n     * Creates a Share instance for the given container if all required elements are present.\n     * @param likePostsContainer - The container element for like posts.\n     * @returns Share instance or null if creation fails.\n     */\n    public create(likePostsContainer: HTMLElement): Share|null {\n        const postTypesToShow   = JSON.parse(likePostsContainer.getAttribute('data-js-like-posts-post-types') || '[]');\n        const postAppearance    = likePostsContainer.getAttribute('data-js-like-posts-appearance') || 'collection';\n        const shareUrlField     = likePostsContainer.querySelector('[data-js-like-share-url]');\n        const shareListField    = likePostsContainer.querySelector('[data-js-like-share-name]');\n        const shareExcerptField = likePostsContainer.querySelector('[data-js-like-share-excerpt]');\n        const shareButton       = likePostsContainer.querySelector('[data-js-like-share-button]');\n\n        if (shareButton && shareUrlField && shareListField && shareExcerptField) {\n            return new Share(\n                this.likeStorage,\n                postTypesToShow,\n                postAppearance,\n                this.likedPostsStructurer,\n                this.likedPostsApiUrlBuilder,\n                shareButton as HTMLButtonElement,\n                shareUrlField as HTMLInputElement,\n                shareListField as HTMLInputElement,\n                shareExcerptField as HTMLInputElement\n            );\n        }\n\n        return null;\n    }\n}\n\nexport default ShareFactory;","import StorageInterface from \"../storage/storageInterface\";\nimport LikeInstancesStorage from \"../storage/likeInstancesStorage\";\n\nconst likedIconClass: string = 'material-symbols--filled';\nconst tooltipAttribute: string = 'data-tooltip';\n\nexport default class Like {\n    private hasTooltip: boolean;\n    private key: string;\n    constructor(\n        private likeStorage: StorageInterface,\n        private likeInstancesStorage: LikeInstancesStorage,\n        private button: Element,\n        private wrapper: Element|null,\n        private postId: string,\n        private postType: string,\n        private tooltipLike: string,\n        private tooltipUnlike: string,\n        private blogId: string\n    ) {\n        this.key = `${this.blogId}-${this.postId}`;\n        this.hasTooltip = Boolean(this.wrapper && (!!this.tooltipLike || !!this.tooltipUnlike));\n        this.updateLikedStatus();\n        this.setTooltip();\n        this.setListener();\n    }\n\n    /**\n     * Sets the event listener for the like button.\n     */\n    private setListener() {\n        this.button.addEventListener('click', (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            this.likeStorage.set(this.postId, this.postType, this.blogId);\n            this.toggleLiked();\n            window.dispatchEvent(this.likedPostsUpdatedEvent());\n        });\n    }\n\n    /**\n     * Sets the tooltip for the like button.\n     */\n    private setTooltip() {\n        if (!this.hasTooltip) {\n            return;\n        }\n\n        const isLiked = this.likeStorage.get()[this.key];\n\n        if (isLiked) {\n            if (this.tooltipUnlike) {\n                this.wrapper!.setAttribute(tooltipAttribute, this.tooltipUnlike);\n            } else {\n                this.wrapper!.removeAttribute(tooltipAttribute);\n            }\n        } else {\n            if (this.tooltipLike) {\n                this.wrapper!.setAttribute(tooltipAttribute, this.tooltipLike);\n            } else {\n                this.wrapper!.removeAttribute(tooltipAttribute);\n            }\n        }\n    }\n\n    /**\n     * Toggles the like button (liked/not liked) and updates all like buttons with the same postId.\n     */\n    private toggleLiked() {\n        this.likeInstancesStorage.getInstances(this.key).forEach((instance) => {\n            instance.updateLikedStatus();\n            instance.setTooltip();\n        });\n\t}\n\n    /**\n     * Updates the state of the like button (liked/not liked).\n     */\n    public updateLikedStatus() {\n        const isLiked = this.likeStorage.get()[this.key];\n        if (isLiked) {\n            this.button.classList.add(likedIconClass);\n        } else {\n            this.button.classList.remove(likedIconClass);\n        }\n    }\n\n    /**\n     * Custom event to update liked posts length.\n     * @returns {CustomEvent}\n     */\n    public likedPostsUpdatedEvent() { \n\t\treturn new CustomEvent('likedPostsLengthUpdated', {});\n    }\n}","import Like from \"./like\";\nimport LikeInstancesStorage from \"../storage/likeInstancesStorage\";\nimport StorageInterface from \"../storage/storageInterface\";\n\nclass LikeFactory {\n    private iconWrapperAttribute: string = 'data-js-like-icon-wrapper';\n    private likeIconInitializedAttribute: string = 'data-like-icon-initialized'\n    private postIdAttribute: string = 'data-post-id';\n    private postTypeAttribute: string = 'data-post-type';\n    private blogIdAttribute: string = 'data-blog-id';\n\n    constructor(\n        private likeStorage: StorageInterface,\n        private likeInstancesStorage: LikeInstancesStorage,\n        private tooltipLike: string, \n        private tooltipUnlike: string\n    ) {}\n\n    /**\n     * Creates and initializes a Like instance for a given like button element.\n     * Ensures the button is only initialized once and stores the instance.\n     *\n     * @param likeButton - The HTML element representing the like button.\n     * @returns The created Like instance, or undefined if already initialized or missing attributes.\n     */\n    public create(likeButton: HTMLElement): Like | undefined {\n        if (likeButton.hasAttribute(this.likeIconInitializedAttribute)) {\n            return undefined;\n        }\n\n        likeButton.setAttribute(this.likeIconInitializedAttribute, 'true');\n\n        const postId   = likeButton.getAttribute(this.postIdAttribute);\n        const postType = likeButton.getAttribute(this.postTypeAttribute);\n        const blogId   = likeButton.getAttribute(this.blogIdAttribute);\n        const wrapper  = likeButton.closest(`[${this.iconWrapperAttribute}]`);\n\n        if (!postId || !postType || !blogId) {\n            console.warn('Like button is missing required blogId for likeable post', likeButton);\n            return undefined;\n        }\n\n        const like = new Like(\n            this.likeStorage, \n            this.likeInstancesStorage,\n            likeButton,\n            wrapper,\n            postId, \n            postType, \n            this.tooltipLike, \n            this.tooltipUnlike,\n            blogId\n        );\n\n        this.likeInstancesStorage.addInstance(\n            `${blogId}-${postId}`,\n            like\n        );\n\n        return like;\n    }\n}\n\nexport default LikeFactory;","import { initializeLikedCounter } from \"./front/likedCounter\";\nimport { LikedPosts, WpApiSettings } from './front/like-posts';\nimport UserStorage from './front/storage/userStorage';\nimport LocalStorage from './front/storage/localStorage';\nimport LikeInstancesStorage from \"./front/storage/likeInstancesStorage\";\nimport LikedPostsStructurer from \"./front/helpers/likedPostsStructurer\";\nimport LikedPostsApiUrlBuilder from \"./front/helpers/likedPostsApiUrlBuilder\";\nimport LikeModuleFactory from \"./front/module/likeModuleFactory\";\nimport ShareFactory from \"./front/module/shareFactory\";\nimport StorageInterface from \"./front/storage/storageInterface\";\nimport LikeFactory from \"./front/like/likeFactory\";\n\ndeclare const likedPosts : {\n    currentUser: number|\"0\",\n    likedPostsMeta: any,\n    tooltipLike: string,\n    tooltipUnlike: string,\n    currentBlogId: string\n};\n\ndeclare const wpApiSettings: WpApiSettings;\n\n/**\n * Initializes the like system when the DOM is fully loaded.\n */\ndocument.addEventListener('DOMContentLoaded', () => {\n    const likeStorage = getStorage(likedPosts as LikedPosts, wpApiSettings);\n\n    initializeLikedCounter(likeStorage);\n    initializeLikeButtons(\n        likeStorage, \n        new LikeInstancesStorage(), \n        likedPosts.tooltipLike, \n        likedPosts.tooltipUnlike\n    );\n\n    initializeModules(likeStorage, wpApiSettings);\n});\n\n/**\n * Returns the appropriate storage implementation based on user authentication.\n *\n * @param likedPosts - The liked posts data for the current user/session.\n * @param localWpApiSettings - The WP API settings object.\n * @returns StorageInterface instance for user or local storage.\n */\nfunction getStorage(likedPosts: LikedPosts, localWpApiSettings: WpApiSettings): StorageInterface {\n    return likedPosts && likedPosts.currentUser && likedPosts.currentUser !== '0' && likedPosts.likedPostsMeta && localWpApiSettings ?\n        new UserStorage(localWpApiSettings, likedPosts.currentUser as unknown as number, likedPosts.likedPostsMeta) :\n        new LocalStorage(localWpApiSettings, likedPosts.currentBlogId);\n}\n\n\n/**\n * Initializes all like buttons/icons on the page and observes for dynamically added buttons.\n *\n * @param likeStorage - The storage interface for like data.\n * @param likeInstancesStorage - Storage for Like instances.\n * @param tooltipLike - Tooltip text for the like action.\n * @param tooltipUnlike - Tooltip text for the unlike action.\n */\nfunction initializeLikeButtons(\n    likeStorage: StorageInterface,\n    likeInstancesStorage: LikeInstancesStorage,\n    tooltipLike: string, \n    tooltipUnlike: string\n) {\n    const likeFactory = new LikeFactory(\n        likeStorage,\n        likeInstancesStorage,\n        tooltipLike,\n        tooltipUnlike\n    );\n\n    document.querySelectorAll('[data-like-icon]').forEach((button) => {\n        likeFactory.create(button as HTMLElement);\n    });\n\n    const observer = new MutationObserver((mutations) => {\n        mutations.forEach((mutation) => {\n            if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {\n                [...mutation.addedNodes].forEach((node) => {\n                    if (node.nodeType === Node.ELEMENT_NODE) {\n                        const element = node as Element;\n    \n                        if (element.matches('[data-like-icon]')) {\n                            likeFactory.create(element as HTMLElement);\n                        } else {\n                            element.querySelectorAll('[data-like-icon]').forEach((button) => {\n                                likeFactory.create(button as HTMLElement);\n                            });\n                        }\n\n                    }\n                });\n            }\n        });\n    });\n    \n    observer.observe(document.body, { childList: true, subtree: true });\n}\n\n/**\n * Initializes LikeModule and ShareModule for all containers on the page.\n *\n * @param likeStorage - The storage interface for like data.\n * @param localWpApiSettings - The WP API settings object.\n */\nfunction initializeModules(\n    likeStorage: StorageInterface,\n    localWpApiSettings: WpApiSettings\n): void {\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const sharedPosts: string|null = urlParams.get('liked-posts');\n\n    const moduleFactory = new LikeModuleFactory(\n        localWpApiSettings,\n        likeStorage,\n        urlParams,\n        sharedPosts\n    );\n\n    const shareFactory = new ShareFactory(\n        likeStorage,\n        new LikedPostsStructurer(),\n        new LikedPostsApiUrlBuilder(localWpApiSettings)\n    );\n\n    document.querySelectorAll('[data-js-like-posts]').forEach((likePostsContainer) => {\n        const likeModule = moduleFactory.create(likePostsContainer as HTMLElement);\n\n        if (!likeModule) {\n            console.error('Failed to initialize LikeModule for container:', likePostsContainer);\n            return;\n        }\n\n        if (likePostsContainer.hasAttribute('data-js-like-posts-share')) {\n            shareFactory.create(likePostsContainer as HTMLElement);\n        }\n    });\n}\n"],"names":["wpApiSettings","likedPosts"],"mappings":"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"}